"use strict";(()=>{var e={};e.id=695,e.ids=[695],e.modules={7096:e=>{e.exports=require("bcrypt")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7022:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>k,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>b,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{POST:()=>l});var s=r(9303),o=r(8716),n=r(670),u=r(6596),p=r(7070),c=r(7096),i=r.n(c);let d=(0,u.eI)("https://ckubfbjfjbhuotyfwmac.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function l(e){try{let{userId:t,count:r=10}=await e.json();if(!t)return p.NextResponse.json({error:"userId required"},{status:400});let a=[],s=[];for(let e=0;e<r;e++){let e=function(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ23456789",t=t=>Array.from({length:t},()=>e[Math.floor(Math.random()*e.length)]).join("");return`${t(4)}-${t(4)}`}(),r=await i().hash(e,12);a.push(e),s.push({employee_id:t,code_hash:r,used:!1})}await d.from("backup_codes").delete().eq("employee_id",t);let{error:o}=await d.from("backup_codes").insert(s);if(o)return console.error("Failed to insert backup codes",o),p.NextResponse.json({error:o.message},{status:500});return p.NextResponse.json({success:!0,codes:a},{status:200})}catch(e){return console.error("generate-backup-codes error",e),p.NextResponse.json({error:e.message||String(e)},{status:500})}}let h=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/generate-backup-codes/route",pathname:"/api/auth/generate-backup-codes",filename:"route",bundlePath:"app/api/auth/generate-backup-codes/route"},resolvedPagePath:"/workspaces/pt-portal/app/api/auth/generate-backup-codes/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:b}=h,f="/api/auth/generate-backup-codes/route";function k(){return(0,n.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:g})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,689,972],()=>r(7022));module.exports=a})();