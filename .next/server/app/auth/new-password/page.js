(()=>{var e={};e.id=32,e.ids=[32],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},504:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>d}),s(2619),s(1506),s(5866);var r=s(3191),a=s(8716),n=s(7922),l=s.n(n),o=s(5231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let d=["",{children:["auth",{children:["new-password",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2619)),"/workspaces/pt-portal/app/auth/new-password/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1506)),"/workspaces/pt-portal/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],u=["/workspaces/pt-portal/app/auth/new-password/page.tsx"],c="/auth/new-password/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/auth/new-password/page",pathname:"/auth/new-password",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3230:(e,t,s)=>{Promise.resolve().then(s.bind(s,874))},2107:()=>{},3164:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},874:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(326),a=s(7577),n=s(6795),l=s(5047);function o(){let[e,t]=(0,a.useState)(""),[s,o]=(0,a.useState)(""),[i,d]=(0,a.useState)(!1),[u,c]=(0,a.useState)(""),[p,m]=(0,a.useState)(""),h=(0,l.useRouter)(),x=(0,n.createBrowserClient)("https://ckubfbjfjbhuotyfwmac.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrdWJmYmpmamJodW90eWZ3bWFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5ODY1NzgsImV4cCI6MjA3NDU2MjU3OH0._Stz6_nHRQMqs2N1HdJ9Y7gEjL60s2ua9d5YcMn1H3Y"),g=e=>{let t=[];return e.length<8&&t.push("at least 8 characters"),/[a-z]/.test(e)||t.push("a lowercase letter"),/[A-Z]/.test(e)||t.push("an uppercase letter"),/[0-9]/.test(e)||t.push("a number"),/[!@#$%^&*(),.?":{}|<>\-_=+\\/\[\];']/.test(e)||t.push("a special character"),t},b=e=>{let t=g(e);return{strength:5-t.length,errors:t}},w=async t=>{if(t.preventDefault(),e!==s)return alert("Passwords do not match");let r=g(e);if(r.length>0)return alert("Password must contain: "+r.join(", "));d(!0);let a=await fetch("/api/auth/update-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:p,newPassword:e})}),n=await a.json();if(a.ok){let{error:t}=await x.auth.signInWithPassword({email:u,password:e});t?(alert("Password updated, but auto-login failed. Please sign in manually."),h.push("/login")):h.push("/login/setup-2fa")}else alert("Error: "+n.error);d(!1)};return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-100",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white p-8 rounded-xl shadow-lg border border-red-100",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[r.jsx("div",{className:"h-12 w-12 bg-red-100 text-red-600 rounded-full flex items-center justify-center mx-auto mb-3 text-2xl",children:"\uD83D\uDD12"}),r.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Security Update Required"}),r.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"You are using a temporary password. Please set a secure password to continue."})]}),(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"New Password"}),r.jsx("input",{type:"password",required:!0,minLength:6,className:"w-full p-3 border rounded focus:ring-2 focus:ring-blue-900 outline-none",value:e,onChange:e=>t(e.target.value)}),e&&(0,r.jsxs)("div",{className:"mt-3 p-3 bg-slate-50 rounded border border-slate-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("div",{className:"flex-1 h-1.5 bg-slate-200 rounded overflow-hidden",children:r.jsx("div",{className:`h-full transition-all ${5===b(e).strength?"bg-green-500 w-full":b(e).strength>=3?"bg-yellow-500 w-3/4":"bg-red-500 w-1/2"}`})}),r.jsx("span",{className:"text-xs font-bold",children:5===b(e).strength?"✓ Strong":b(e).strength>=3?"Fair":"Weak"})]}),b(e).errors.length>0&&(0,r.jsxs)("div",{className:"text-xs text-slate-600",children:[r.jsx("p",{className:"font-bold mb-1",children:"Password must contain:"}),r.jsx("ul",{className:"space-y-0.5",children:b(e).errors.map((e,t)=>(0,r.jsxs)("li",{children:["• ",e]},t))})]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Confirm Password"}),r.jsx("input",{type:"password",required:!0,minLength:6,className:"w-full p-3 border rounded focus:ring-2 focus:ring-blue-900 outline-none",value:s,onChange:e=>o(e.target.value)})]}),r.jsx("button",{type:"submit",disabled:i,className:"w-full bg-blue-900 text-white py-3 rounded-lg font-bold hover:bg-blue-800 transition",children:i?"Updating...":"Set Password & Login"})]})]})})}},2619:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/workspaces/pt-portal/app/auth/new-password/page.tsx#default`)},1506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>a});var r=s(9510);s(7272);let a={title:"Piyam Travels IMS",description:"Employee Information Management System"};function n({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{children:e})})}},7272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,471,730],()=>s(504));module.exports=r})();