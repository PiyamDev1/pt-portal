"use strict";(()=>{var e={};e.id=695,e.ids=[695],e.modules={7096:e=>{e.exports=require("bcrypt")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7022:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>b,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{POST:()=>d});var s=r(9303),o=r(8716),n=r(670),u=r(6596),p=r(7070),c=r(7096),i=r.n(c);async function d(e){try{let t=(0,u.eI)("https://ckubfbjfjbhuotyfwmac.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY),{userId:r,count:a=10}=await e.json();if(!r)return p.NextResponse.json({error:"userId required"},{status:400});let s=[],o=[];for(let e=0;e<a;e++){let e=function(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ23456789",t=t=>Array.from({length:t},()=>e[Math.floor(Math.random()*e.length)]).join("");return`${t(4)}-${t(4)}`}(),t=await i().hash(e,12);s.push(e),o.push({employee_id:r,code_hash:t,used:!1})}await t.from("backup_codes").delete().eq("employee_id",r);let{error:n}=await t.from("backup_codes").insert(o);if(n)return console.error("Failed to insert backup codes",n),p.NextResponse.json({error:n.message},{status:500});return p.NextResponse.json({success:!0,codes:s},{status:200})}catch(e){return console.error("generate-backup-codes error",e),p.NextResponse.json({error:e.message||String(e)},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/generate-backup-codes/route",pathname:"/api/auth/generate-backup-codes",filename:"route",bundlePath:"app/api/auth/generate-backup-codes/route"},resolvedPagePath:"/workspaces/pt-portal/app/api/auth/generate-backup-codes/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:g}=l,b="/api/auth/generate-backup-codes/route";function f(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,689,972],()=>r(7022));module.exports=a})();