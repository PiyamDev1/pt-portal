(()=>{var e={};e.id=455,e.ids=[455],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6088:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o}),t(7631),t(1506),t(5866);var a=t(3191),l=t(8716),r=t(7922),n=t.n(r),i=t(5231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let o=["",{children:["dashboard",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7631)),"/workspaces/pt-portal/app/dashboard/settings/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"/workspaces/pt-portal/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/workspaces/pt-portal/app/dashboard/settings/page.tsx"],m="/dashboard/settings/page",u={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/dashboard/settings/page",pathname:"/dashboard/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},2290:(e,s,t)=>{Promise.resolve().then(t.bind(t,3784)),Promise.resolve().then(t.bind(t,4284)),Promise.resolve().then(t.bind(t,2903))},2107:()=>{},3164:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},3784:(e,s,t)=>{"use strict";t.d(s,{default:()=>d});var a=t(326),l=t(434),r=t(5047),n=t(6795);function i(){let e=(0,r.useRouter)(),s=(0,n.createBrowserClient)("https://ckubfbjfjbhuotyfwmac.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrdWJmYmpmamJodW90eWZ3bWFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5ODY1NzgsImV4cCI6MjA3NDU2MjU3OH0._Stz6_nHRQMqs2N1HdJ9Y7gEjL60s2ua9d5YcMn1H3Y"),t=async()=>{await s.auth.signOut(),e.push("/login"),e.refresh()};return a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition border border-red-100",children:"Sign Out"})}function d({employeeName:e,role:s,location:t,showBack:n=!1}){let d=(0,r.useRouter)();return(0,a.jsxs)("nav",{className:"bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(l.default,{href:"/dashboard",className:"cursor-pointer hover:opacity-80 transition",children:a.jsx("div",{className:"h-10 w-10 bg-blue-900 rounded-full flex items-center justify-center text-white font-bold",children:"PT"})}),(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-lg font-bold text-slate-800",children:"Piyam Travels Portal"}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[t?.name," (",t?.branch_code,")"]})]}),n&&a.jsx("button",{onClick:()=>d.back(),className:"ml-4 text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:"← Back"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"text-right hidden sm:block",children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:e}),a.jsx("p",{className:"text-xs text-blue-600 font-semibold",children:s})]}),a.jsx(i,{})]})]})}},4284:(e,s,t)=>{"use strict";t.d(s,{default:()=>d});var a=t(326),l=t(7577),r=t(5047),n=t(6795);function i({showWarning:e,secondsRemaining:s}){let[t,r]=(0,l.useState)(!1);if(!t||!e)return null;let n=s/30*100;return a.jsx("div",{className:"fixed top-16 left-0 right-0 z-40 pointer-events-none flex justify-center px-4 py-4",children:(0,a.jsxs)("div",{className:"relative bg-white border-2 border-red-300 rounded-lg shadow-lg max-w-md w-full pointer-events-auto",children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gray-200 rounded-t-md overflow-hidden",children:a.jsx("div",{className:"h-full bg-red-500 transition-all duration-1000 ease-linear",style:{width:`${n}%`}})}),a.jsx("div",{className:"p-4 pt-5",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 102 0V6z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Session ending soon"}),a.jsx("p",{className:"text-xs text-slate-600",children:"Move your mouse or press a key to stay logged in"})]})]}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-red-600 tabular-nums min-w-12 text-right",children:[s,"s"]})]})})]})})}function d({children:e}){let[s,t]=(0,l.useState)(!1),[d,o]=(0,l.useState)(0);return function(e){let s=(0,r.useRouter)(),t=(0,n.createBrowserClient)("https://ckubfbjfjbhuotyfwmac.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrdWJmYmpmamJodW90eWZ3bWFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5ODY1NzgsImV4cCI6MjA3NDU2MjU3OH0._Stz6_nHRQMqs2N1HdJ9Y7gEjL60s2ua9d5YcMn1H3Y"),[a,i]=(0,l.useState)(!1),[d,o]=(0,l.useState)(0);(0,l.useCallback)(async()=>{await t.auth.signOut(),s.push("/login")},[t,s])}((e,s)=>{t(e),o(s||0)}),(0,a.jsxs)(a.Fragment,{children:[a.jsx(i,{showWarning:s,secondsRemaining:d}),e]})}},2903:(e,s,t)=>{"use strict";t.d(s,{default:()=>i});var a=t(326),l=t(7577),r=t(6795),n=t(5047);function i({initialLocations:e,initialDepts:s,initialRoles:t,initialEmployees:i}){let[d,o]=(0,l.useState)("branches"),[c,m]=(0,l.useState)(e),[u,x]=(0,l.useState)(i),[h,p]=(0,l.useState)(""),[b,g]=(0,l.useState)(""),[f,j]=(0,l.useState)(null),[N,v]=(0,l.useState)(!1),[y,w]=(0,l.useState)(null),[_,I]=(0,l.useState)(null),[C,S]=(0,l.useState)({firstName:"",lastName:"",email:"",role_id:"",department_ids:[],location_id:""}),[k,J]=(0,l.useState)(!1),P=(0,r.createBrowserClient)("https://ckubfbjfjbhuotyfwmac.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrdWJmYmpmamJodW90eWZ3bWFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5ODY1NzgsImV4cCI6MjA3NDU2MjU3OH0._Stz6_nHRQMqs2N1HdJ9Y7gEjL60s2ua9d5YcMn1H3Y"),M=(0,n.useRouter)(),O=async e=>{e.preventDefault(),J(!0);let{data:s,error:t}=await P.from("locations").insert({name:h,branch_code:b,type:"Branch"}).select();!t&&s?(m([...c,s[0]]),p(""),g("")):alert("Error: "+t?.message),J(!1)},E=async()=>{if(!f)return;J(!0);let{error:e}=await P.from("locations").update({name:f.name,branch_code:f.branch_code}).eq("id",f.id);e?alert("Error updating branch: "+e.message):(m(c.map(e=>e.id===f.id?f:e)),j(null),M.refresh()),J(!1)},Y=e=>{S(s=>{let t=s.department_ids.includes(e);return{...s,department_ids:t?s.department_ids.filter(s=>s!==e):[...s.department_ids,e]}})},A=async e=>{e.preventDefault(),J(!0);try{let e=await fetch("/api/admin/add-employee",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}),s=await e.json();e.ok?(alert("Success! User created."),v(!1),S({firstName:"",lastName:"",email:"",role_id:"",department_ids:[],location_id:""}),M.refresh()):alert("Error: "+(s.error||"Unknown error"))}catch(e){alert("Network Error")}J(!1)},z=async({employee_id:e,email:s})=>{let t=await fetch("/api/admin/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e?{employee_id:e}:{email:s})}),a=await t.json();if(!t.ok)throw Error(a.error||"Failed to reset password");return a},R=async()=>{if(!y)return;J(!0);let{error:e}=await P.from("employees").update({role_id:y.role_id,department_id:y.department_id,location_id:y.location_id,manager_id:y.manager_id}).eq("id",y.id);e?alert("Failed to update: "+e.message):(x(u.map(e=>e.id===y.id?y:e)),w(null),M.refresh()),J(!1)},q=async(e,s)=>{let{error:t}=await P.from("employees").update({manager_id:"null"===s?null:s}).eq("id",e);t?alert("Error moving employee: "+t.message):(x(u.map(t=>t.id===e?{...t,manager_id:"null"===s?null:s}:t)),M.refresh())},F=({employee:s,level:l})=>{let r=u.filter(e=>e.manager_id===s.id);return(0,a.jsxs)("div",{className:"mb-2 relative",children:[(0,a.jsxs)("div",{className:`flex items-center gap-3 p-3 rounded-lg border border-slate-200 bg-white shadow-sm hover:border-blue-300 transition-colors ml-${6*l}`,style:{marginLeft:`${2*l}rem`},children:[l>0&&a.jsx("div",{className:"absolute -left-4 top-1/2 w-4 h-px bg-slate-300"}),a.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center text-xs font-bold text-white
            ${0===l?"bg-purple-600":1===l?"bg-blue-600":"bg-slate-500"}`,children:s.full_name.charAt(0)}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-bold text-slate-800",children:s.full_name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[t.find(e=>e.id===s.role_id)?.name," • ",e.find(e=>e.id===s.location_id)?.name||"No Branch"]})]}),(0,a.jsxs)("select",{className:"text-xs border rounded p-1 bg-slate-50 text-slate-600 focus:ring-2 focus:ring-blue-500 outline-none w-40",value:s.manager_id||"null",onChange:e=>q(s.id,e.target.value),children:[a.jsx("option",{value:"null",children:"No Manager (Root)"}),u.filter(e=>e.id!==s.id).map(e=>(0,a.jsxs)("option",{value:e.id,children:["Report to: ",e.full_name]},e.id))]})]}),a.jsx("div",{className:"border-l-2 border-slate-100 ml-4",children:r.map(e=>a.jsx(F,{employee:e,level:l+1},e.id))})]})},H=(0,l.useMemo)(()=>u.filter(e=>!e.manager_id),[u]);return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-8 min-h-screen",children:[a.jsx("div",{className:"w-full md:w-64 flex-shrink-0",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow border border-slate-200 overflow-hidden sticky top-24",children:[a.jsx("button",{onClick:()=>o("branches"),className:`w-full text-left px-4 py-3 border-l-4 transition-colors ${"branches"===d?"border-blue-900 bg-blue-50 font-medium text-blue-900":"border-transparent hover:bg-slate-50 text-slate-600"}`,children:"Branches & Locations"}),a.jsx("button",{onClick:()=>o("staff"),className:`w-full text-left px-4 py-3 border-l-4 transition-colors ${"staff"===d?"border-blue-900 bg-blue-50 font-medium text-blue-900":"border-transparent hover:bg-slate-50 text-slate-600"}`,children:"Staff Management"}),a.jsx("button",{onClick:()=>o("hierarchy"),className:`w-full text-left px-4 py-3 border-l-4 transition-colors ${"hierarchy"===d?"border-blue-900 bg-blue-50 font-medium text-blue-900":"border-transparent hover:bg-slate-50 text-slate-600"}`,children:"Hierarchy Tree"})]})}),(0,a.jsxs)("div",{className:"flex-1 space-y-6",children:["branches"===d&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[a.jsx("h3",{className:"font-bold text-lg mb-4 text-slate-800",children:"Add New Location"}),(0,a.jsxs)("form",{onSubmit:O,className:"flex gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-1",children:"Branch Name"}),a.jsx("input",{type:"text",placeholder:"e.g. Manchester Office",required:!0,className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",value:h,onChange:e=>p(e.target.value)})]}),(0,a.jsxs)("div",{className:"w-32",children:[a.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-1",children:"Code"}),a.jsx("input",{type:"text",placeholder:"MAN-01",required:!0,className:"w-full p-2 border rounded uppercase focus:ring-2 focus:ring-blue-500 outline-none",value:b,onChange:e=>g(e.target.value.toUpperCase())})]}),a.jsx("button",{disabled:k,className:"bg-blue-900 text-white px-6 py-2 rounded hover:bg-blue-800 font-medium transition-colors",children:k?"Adding...":"Add Branch"})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"bg-slate-50 text-slate-500 font-semibold border-b",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3",children:"Location Name"}),a.jsx("th",{className:"px-6 py-3",children:"Branch Code"}),a.jsx("th",{className:"px-6 py-3",children:"Type"}),a.jsx("th",{className:"px-6 py-3",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:c.map(e=>a.jsx("tr",{className:"hover:bg-slate-50",children:f?.id===e.id?(0,a.jsxs)(a.Fragment,{children:[a.jsx("td",{className:"px-6 py-3",children:a.jsx("input",{className:"border p-1 rounded w-full",value:f.name,onChange:e=>j({...f,name:e.target.value})})}),a.jsx("td",{className:"px-6 py-3",children:a.jsx("input",{className:"border p-1 rounded w-24 uppercase",value:f.branch_code,onChange:e=>j({...f,branch_code:e.target.value.toUpperCase()})})}),a.jsx("td",{className:"px-6 py-3 text-slate-400",children:e.type}),(0,a.jsxs)("td",{className:"px-6 py-3 flex gap-3",children:[a.jsx("button",{onClick:E,className:"text-green-600 font-bold hover:underline",children:"Save"}),a.jsx("button",{onClick:()=>j(null),className:"text-slate-400 hover:underline",children:"Cancel"})]})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:e.name}),a.jsx("td",{className:"px-6 py-3 font-mono text-slate-500",children:e.branch_code||"-"}),a.jsx("td",{className:"px-6 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs ${"HQ"===e.type?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:e.type})}),a.jsx("td",{className:"px-6 py-3",children:a.jsx("button",{onClick:()=>j(e),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Edit"})})]})},e.id))})]})})]}),"staff"===d&&a.jsx("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center",children:[a.jsx("h3",{className:"font-bold text-slate-700",children:"Staff Directory"}),a.jsx("button",{onClick:()=>v(!N),className:"text-sm bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition font-medium",children:N?"Cancel":"+ Invite New Employee"})]}),N&&(0,a.jsxs)("div",{className:"p-6 bg-blue-50 border-b border-blue-100 animate-fade-in",children:[a.jsx("h4",{className:"font-bold text-blue-900 mb-4",children:"New Employee Details"}),(0,a.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("input",{placeholder:"First Name",required:!0,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",value:C.firstName,onChange:e=>S({...C,firstName:e.target.value})}),a.jsx("input",{placeholder:"Last Name",required:!0,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",value:C.lastName,onChange:e=>S({...C,lastName:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("input",{type:"email",placeholder:"Email Address",required:!0,className:"p-2 border rounded focus:ring-2 focus:ring-blue-500 outline-none",value:C.email,onChange:e=>S({...C,email:e.target.value})}),(0,a.jsxs)("select",{required:!0,className:"p-2 border rounded bg-white focus:ring-2 focus:ring-blue-500 outline-none",value:C.role_id,onChange:e=>S({...C,role_id:e.target.value}),children:[a.jsx("option",{value:"",children:"Select Role"}),t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"bg-white p-4 border rounded-lg",children:[a.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-3",children:"Assign Departments"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:s.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer p-2 hover:bg-slate-50 rounded border border-transparent hover:border-slate-200 transition",children:[a.jsx("input",{type:"checkbox",value:e.id,checked:C.department_ids.includes(e.id),onChange:()=>Y(e.id),className:"rounded border-slate-300 text-blue-900 focus:ring-blue-900 w-4 h-4"}),e.name]},e.id))})]}),(0,a.jsxs)("select",{className:"w-full p-2 border rounded bg-white focus:ring-2 focus:ring-blue-500 outline-none",value:C.location_id,onChange:e=>S({...C,location_id:e.target.value}),children:[a.jsx("option",{value:"",children:"Select Branch (Optional)"}),c.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]}),a.jsx("button",{disabled:k,className:"w-full bg-blue-900 text-white py-3 rounded hover:bg-blue-800 font-bold transition-colors",children:k?"Creating Account & Sending Email...":"Create Account"})]})]}),(0,a.jsxs)("table",{className:"w-full text-sm text-left",children:[a.jsx("thead",{className:"bg-slate-50 text-slate-500 font-semibold border-b",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-4 py-3",children:"Name"}),a.jsx("th",{className:"px-4 py-3",children:"Role"}),a.jsx("th",{className:"px-4 py-3",children:"Branch"}),a.jsx("th",{className:"px-4 py-3",children:"Department"}),a.jsx("th",{className:"px-4 py-3",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:u.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-slate-50",children:[(0,a.jsxs)("td",{className:"px-4 py-3 font-medium",children:[e.full_name,a.jsx("div",{className:"text-xs text-slate-400 font-normal",children:e.email})]}),y?.id===e.id?(0,a.jsxs)(a.Fragment,{children:[a.jsx("td",{className:"px-2 py-3",children:(0,a.jsxs)("select",{className:"border rounded p-1 w-full",value:y.role_id||"",onChange:e=>w({...y,role_id:e.target.value}),children:[a.jsx("option",{value:"",children:"- Role -"}),t.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})}),a.jsx("td",{className:"px-2 py-3",children:(0,a.jsxs)("select",{className:"border rounded p-1 w-full",value:y.location_id||"",onChange:e=>w({...y,location_id:e.target.value}),children:[a.jsx("option",{value:"",children:"- Branch -"}),c.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})}),a.jsx("td",{className:"px-2 py-3",children:a.jsx("span",{className:"text-xs text-gray-400 italic",children:"Manage via Profile"})}),(0,a.jsxs)("td",{className:"px-4 py-3 flex gap-2",children:[a.jsx("button",{onClick:R,className:"text-green-600 font-bold hover:underline",children:"Save"}),a.jsx("button",{onClick:()=>w(null),className:"text-slate-400 hover:underline",children:"Cancel"})]})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx("td",{className:"px-4 py-3",children:t.find(s=>s.id===e.role_id)?.name||"-"}),a.jsx("td",{className:"px-4 py-3",children:c.find(s=>s.id===e.location_id)?.name||"-"}),a.jsx("td",{className:"px-4 py-3",children:s.find(s=>s.id===e.department_id)?.name||"-"}),(0,a.jsxs)("td",{className:"px-4 py-3",children:[a.jsx("button",{onClick:()=>w(e),className:"text-blue-600 hover:text-blue-800 font-medium",children:"Edit"}),a.jsx("button",{onClick:async()=>{if(confirm(`Send a temporary password to ${e.email}?`))try{I(e.id);let s=await z({employee_id:e.id});alert(s.message||"Temporary password emailed")}catch(e){alert("Error: "+(e.message||e))}finally{I(null)}},disabled:k||_===e.id,className:"ml-3 text-red-600 hover:underline",children:_===e.id?"Sending...":"Reset Password"})]})]})]},e.id))})]})]})}),"hierarchy"===d&&a.jsx("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-200",children:[a.jsx("h3",{className:"font-bold text-lg mb-2 text-slate-800",children:"Organization Hierarchy"}),a.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"Visualise reporting lines. Use the dropdown on any employee card to change their manager."}),(0,a.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-200 min-h-[400px]",children:[0===H.length&&a.jsx("p",{className:"text-center text-gray-400 py-10",children:"No employees found."}),H.map(e=>a.jsx(F,{employee:e,level:0},e.id))]})]})})]})]})}},6494:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8570).createProxy)(String.raw`/workspaces/pt-portal/app/components/PageHeader.client.tsx#default`)},7673:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(8570).createProxy)(String.raw`/workspaces/pt-portal/app/dashboard/client-wrapper.tsx#default`)},7631:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var a=t(9510),l=t(8231),r=t(1615),n=t(8585);let i=(0,t(8570).createProxy)(String.raw`/workspaces/pt-portal/app/dashboard/settings/client.tsx#default`);var d=t(6494),o=t(7673);async function c(){let e=await (0,r.cookies)(),s=(0,l.createServerClient)("https://ckubfbjfjbhuotyfwmac.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrdWJmYmpmamJodW90eWZ3bWFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5ODY1NzgsImV4cCI6MjA3NDU2MjU3OH0._Stz6_nHRQMqs2N1HdJ9Y7gEjL60s2ua9d5YcMn1H3Y",{cookies:{getAll:()=>e.getAll(),setAll(s){try{s.forEach(({name:s,value:t,options:a})=>e.set(s,t,a))}catch{}}}}),{data:{session:t}}=await s.auth.getSession();t||(0,n.redirect)("/login");let[c,m,u,x,h]=await Promise.all([s.from("locations").select("*").order("name"),s.from("departments").select("*").order("name"),s.from("roles").select("*").order("level"),s.from("employees").select("id, full_name, email, role_id, department_id, location_id, manager_id"),s.from("employees").select("full_name, roles(name), locations(name, branch_code)").eq("id",t.user.id).single()]),p=Array.isArray(h?.data?.locations)?h.data.locations[0]:h?.data?.locations,b=Array.isArray(h?.data?.roles)?h.data.roles[0]:h?.data?.roles;return a.jsx(o.Z,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[a.jsx(d.Z,{employeeName:h?.data?.full_name,role:b?.name,location:p,showBack:!0}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto p-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:"Organization Settings"}),a.jsx("p",{className:"text-slate-500 mb-8",children:"Manage branches, structure, and staff access levels."}),a.jsx(i,{initialLocations:c.data||[],initialDepts:m.data||[],initialRoles:u.data||[],initialEmployees:x.data||[]})]})]})})}},1506:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r,metadata:()=>l});var a=t(9510);t(7272);let l={title:"Piyam Travels IMS",description:"Employee Information Management System"};function r({children:e}){return a.jsx("html",{lang:"en",children:a.jsx("body",{children:e})})}},7272:()=>{}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,689,471,730,434,303],()=>t(6088));module.exports=a})();